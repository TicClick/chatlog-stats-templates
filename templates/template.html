<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ name }} stats</title>
    <meta name="description" content="{{ name }} stats">
    <link rel="stylesheet" href="styles/main.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        html, body {
            width: 100%;
            min-height: 100%;
        }
        body {
            background: linear-gradient(135deg, #181c2f 0%, #232946 100%);
            color: #e0e7ff;
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        h1, h2, h3 {
            color: #7ca7ff;
            margin-bottom: 0.5em;
        }
        hr {
            border: none;
            border-top: 2px solid #7ca7ff;
            margin: 2em 0;
        }
        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            background: #232946;
            box-shadow: 0 2px 8px rgba(124,167,255,0.08);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 2em;
        }
        th, td {
            padding: 12px 8px;
            text-align: center;
            font-size: 1em;
        }
        th {
            background: #1a233a;
            color: #e0e7ff;
            font-weight: 600;
        }
        tr:nth-child(even) td {
            background: #232946;
        }
        tr:nth-child(odd) td {
            background: #1a1f2e;
        }
        .ct-chart {
            background: rgba(124,167,255,0.07);
            width: 90%;
            max-width: 600px;
            height: 400px;
            margin: 1em auto;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(124,167,255,0.08);
        }
        details summary {
            cursor: pointer;
            font-weight: 500;
            color: #7ca7ff;
            margin-bottom: 1em;
        }
        .mostactive, .bignumbersusers, .mostusedurls, .mostactivetotal {
            margin: 2em auto;
            max-width: 900px;
            background: #1a1f2e;
            border-radius: 16px;
            box-shadow: 0 2px 12px rgba(124,167,255,0.07);
            padding: 2em 1em;
        }
        .runnerups table {
            margin-top: 1em;
            background: none;
            box-shadow: none;
        }
        .runnerups td {
            background: #232946 !important;
            color: #7ca7ff;
            font-weight: 500;
            border-radius: 8px;
        }
        a {
            color: #7ca7ff;
            text-decoration: none;
            transition: color 0.2s;
        }
        a:hover {
            color: #e0e7ff;
            text-decoration: underline;
        }
        img.icon, .mostactive img {
            border-radius: 50%;
            border: 2px solid #7ca7ff;
            background: #232946;
            box-shadow: 0 1px 4px rgba(124,167,255,0.12);
            transition: transform 0.2s;
        }
        .mostactive img:hover {
            transform: scale(1.08);
        }
        .mostactive td, .mostusedurls td, .mostactivetotal td {
            vertical-align: middle;
        }
        .bignumbersusers span {
            display: block;
            margin: 0.5em 0;
            font-size: 1.05em;
        }
        .bignumbersusers span[style*="font-size:10px"] {
            font-size: 0.9em !important;
            color: #aab4d4;
        }
        .mostusedurls a {
            word-break: break-all;
            color: #7ca7ff;
        }
        /* Responsive styles */
        @media (max-width: 900px) {
            .mostactive, .bignumbersusers, .mostusedurls, .mostactivetotal {
                max-width: 98vw;
            }
        }
        @media (max-width: 700px) {
            .mostactive, .bignumbersusers, .mostusedurls, .mostactivetotal {
                padding: 1em 0.2em;
                max-width: 100vw;
            }
            .ct-chart {
                width: 100% !important;
                min-width: 0;
                height: 250px;
            }
            table, th, td {
                font-size: 0.95em;
            }
            th, td {
                padding: 8px 4px;
            }
        }
        @media (max-width: 600px) {
            .ct-chart {
                height: 180px;
            }
            table, th, td {
                font-size: 0.9em;
            }
            .mostactive, .bignumbersusers, .mostusedurls, .mostactivetotal {
                padding: 0.5em 0.1em;
            }
        }
        @media (max-width: 500px) {
            .ct-chart {
                height: 120px;
            }
            table, th, td {
                font-size: 0.85em;
            }
            .mostactive, .bignumbersusers, .mostusedurls, .mostactivetotal {
                padding: 0.2em 0;
            }
            /* Make tables scrollable horizontally */
            table {
                display: block;
                overflow-x: auto;
                width: 100%;
            }
        }
        /* Optional: Hide less important columns on very small screens */
        @media (max-width: 400px) {
            .mostactive th:nth-child(4), .mostactive td:nth-child(4),
            .mostusedurls th:nth-child(4), .mostusedurls td:nth-child(4) {
                display: none;
            }
        }
    </style>
</head>
<body>
<!-- <div style="text-align:center; margin-top:1em;">
    <a href="https://moscowosu.events/?utm_source=rainbowtaveslogger">
        <img src="https://rtvs.s-ul.eu/DNQDcgcV" style="border-radius:12px; box-shadow:0 2px 8px rgba(124,167,255,0.12);">
    </a>
</div> -->
<h1 style="text-align:center;">Chat statistics for channel <span style="color:#7ca7ff;">{{ name }}</span></h1>
<small style="display:block; text-align:center; margin-bottom:1em;">
    on osu!Bancho IRC provided by
    <a href="https://osu.ppy.sh/u/10079847"><b>Rainbowtaves</b></a>
</small>
<hr>
<h1 style="text-align:center;">Activity chart</h1>
<details style="text-align:center;">
    <summary>Click here to view graph!</summary>
    <div id='myDivChart' class="ct-chart"></div>
    <script>
        var trace1 = {
            x: [0, 1, 2, 3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],
            y: [{{ activity_graph[0] }},{{ activity_graph[1] }},{{ activity_graph[2] }},{{ activity_graph[3] }},{{ activity_graph[4] }},{{ activity_graph[5] }},{{ activity_graph[6] }},{{ activity_graph[7] }},{{ activity_graph[8] }},{{ activity_graph[9] }},{{ activity_graph[10] }},{{ activity_graph[11] }},{{ activity_graph[12] }},{{ activity_graph[13] }},{{ activity_graph[14] }},{{ activity_graph[15] }},{{ activity_graph[16] }},{{ activity_graph[17] }},{{ activity_graph[18] }},{{ activity_graph[19] }},{{ activity_graph[20] }},{{ activity_graph[21] }},{{ activity_graph[22] }},{{ activity_graph[23] }}],
            type: 'scatter',
            line: { color: '#7ca7ff', width: 3 }
        };
        var data = [trace1];
        var layout = {
            margin: { t: 30, l: 40, r: 20, b: 40 },
            plot_bgcolor: 'rgba(26,31,46,0.95)',
            paper_bgcolor: 'rgba(26,31,46,0.0)',
            xaxis: { title: 'Hour (MSK)', tickmode: 'linear', dtick: 1, color: '#e0e7ff', gridcolor: '#232946' },
            yaxis: { title: 'Messages (%)', rangemode: 'tozero', color: '#e0e7ff', gridcolor: '#232946' }
        };
        Plotly.newPlot('myDivChart', data, layout, {responsive: true});
    </script>
    <div style="text-align:center; margin-top:0.5em; color:#aab4d4;"></div>
        Percentage of messages over time.<br>
        According to server time (MSK).
</details>
<hr>

<div class="mostactive">
    <h1 style="text-align:center">Most active users</h1>
    <div style="overflow-x:auto;">
    <table>
        <tr>
            <th>No.</th>
            <th>Nick</th>
            <th>Messages</th>
            <th class="random-quote-col">Random quote</th>
            <th>Avatar</th>
        </tr>
        {% for item in most_active %}
        <tr
            {% if loop.index == 1 %}
                style="background: #fffbe6; color: #bfa100; font-weight: bold;"
            {% elif loop.index == 2 %}
                style="background: #f2f3f7; color: #e0e0e0; font-weight: bold;"
            {% elif loop.index == 3 %}
                style="background: #fff4e0; color: #b87333; font-weight: bold;"
            {% endif %}
        >
            <td>{{ loop.index }}</td>
            <td>
                {% if loop.index == 1 %}
                    <span style="vertical-align:middle;">
                        <svg width="18" height="18" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:3px;">
                            <path fill="#FFD700" d="M12 2l2.39 4.84L20 7.27l-4 3.89L16.18 17 12 14.27 7.82 17 8 11.16l-4-3.89 5.61-.43z"/>
                        </svg>
                    </span>
                {% elif loop.index == 2 %}
                    <span style="vertical-align:middle;">
                        <svg width="18" height="18" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:3px;">
                            <path fill="#E0E0E0" d="M12 2l2.39 4.84L20 7.27l-4 3.89L16.18 17 12 14.27 7.82 17 8 11.16l-4-3.89 5.61-.43z"/>
                        </svg>
                    </span>
                {% elif loop.index == 3 %}
                    <span style="vertical-align:middle;">
                        <svg width="18" height="18" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:3px;">
                            <path fill="#CD7F32" d="M12 2l2.39 4.84L20 7.27l-4 3.89L16.18 17 12 14.27 7.82 17 8 11.16l-4-3.89 5.61-.43z"/>
                        </svg>
                    </span>
                {% endif %}
                {{ item.username }}
            </td>
            <td>{{ item.message_count }}</td>
            <td class="random-quote-col" style="text-align:left">{{ item.random_quote }}</td>
            <td>
                <a href="http://osu.ppy.sh/u/{{ item.user_id }}">
                    <img src="http://a.ppy.sh/{{ item.user_id }}"
                        style="max-width: 64px; max-height: 64px; border-radius: 50%; border: 3px solid
                        {% if loop.index == 1 %}#FFD700
                        {% elif loop.index == 2 %}#E0E0E0
                        {% elif loop.index == 3 %}#CD7F32
                        {% else %}#7ca7ff
                        {% endif %}
                        ; background: #232946; box-shadow: 0 1px 4px rgba(124,167,255,0.12);"
                        alt="avatar">
                </a>
            </td>
        </tr>
        {% endfor %}
    </table>
    </div>
    <style>
        /* Ensure Random quote column is always visible */
        @media (max-width: 400px) {
            .mostactive th:nth-child(4), .mostactive td:nth-child(4),
            .mostusedurls th:nth-child(4), .mostusedurls td:nth-child(4) {
                display: table-cell !important;
            }
        }
        /* Optionally, allow horizontal scroll for table on small screens */
        @media (max-width: 600px) {
            .mostactive table {
                display: block;
                overflow-x: auto;
                width: 100%;
            }
        }
    </style>
    <div class="runnerups">
        <table>
            <tr>
                {% for item in runner_ups[:5] %}
                <td>{{ 26+loop.index0 }}. {{ item[0] }} ({{ item[1] }} messages)</td>
                {% endfor %}
            </tr>
            <tr>
                {% for item in runner_ups[5:] %}
                <td>{{ 31+loop.index0 }}. {{ item[0] }} ({{ item[1] }} messages)</td>
                {% endfor %}
            </tr>
        </table>
    </div>
</div>

<hr>

<div class="bignumbersusers" style="text-align:center"><h1 style="text-align:center">User big numbers</h1><br>
    <span><font color="#336eff">{{ being["screaming"][0][0] }}</font> is screaming too much or has a hearing problem! <font color="#336eff">{{ being["screaming"][0][1] }}</font> lines contained exclamation mark!</span><br>
    <span style="font-size:10px"><font color="#336eff">{{ being["screaming"][1][0] }}</font> is helping <font color="#336eff">{{ being["screaming"][0][0] }}</font> expand exclamation mark revolution, <font color="#336eff">{{ being["screaming"][1][1] }}</font> lines.</span><br>

    <span><font color="#336eff">{{ being["asking"][0][0] }}</font> is asking too much questions, <font color="#336eff">{{ being["asking"][0][1] }}</font> lines contained question mark!</span><br>
    <span style="font-size:10px"><font color="#336eff">{{ being["asking"][1][0] }}</font> is probably chased by FBI by now, <font color="#336eff">{{ being["asking"][1][1] }}</font> lines.</span><br>

    <span><font color="#336eff">{{ being["telling"][0][0] }}</font> is always telling us what is he\she doing - <font color="#336eff">{{ being["telling"][0][1] }}</font> actions!</span><br>
    <span style="font-size:10px"><font color="#336eff">{{ being["telling"][1][0] }}</font> tells us what's up too, <font color="#336eff">{{ being["telling"][1][1] }}</font> actions!</span><br>

    <span><font color="#336eff">{{ being["modding"][0][0] }}</font> got mode from BanchoBot <font color="#336eff">{{ being["modding"][0][1] }}</font> times</span><br>
    <span style="font-size:10px"><font color="#336eff">{{ being["modding"][1][0] }}</font> got only <font color="#336eff">{{ being["modding"][1][1] }}</font> times.</span><br>
</div>

<hr>

<div class="mostusedurls" style="text-align:center">
    <h1>Most used urls</h1>
    <div style="overflow-x:auto;">
    <table style="text-align:center">
        <tr>
            <th>No.</th>
            <th>Link</th>
            <th>Times</th>
            <th>Last used by</th>
        </tr>
        {% for item in urls_used %}
        <tr>
            <td>{{ loop.index }}.</td>
            <td><a href="{{ item.address }}">{{ item.address }}</a></td>
            <td>{{ item.count }}</td>
            <td>{{ item.last_used_username }}</td>
        </tr>
        {% endfor %}
    </table>
    </div>
</div>

<hr>

<div class="mostactivetotal" style="text-align:center">
    <h1>Total big numbers</h1>
    <table style="text-align:center">
        <tr>
            <th>Total lines with question marks</th>
            <td>{{ total[0] }}</td>
        </tr>
        <tr>
            <th>Total lines with exclamation marks</th>
            <td>{{ total[1] }}</td>
        </tr>
        <tr>
            <th>Total actions triggered</th>
            <td>{{ total[2] }}</td>
        </tr>
        <tr>
            <th>Total BanchoBot given modes</th>
            <td>{{ total[3] }}</td>
        </tr>
    </table>
</div>

<hr><br>
<div style="text-align:center; font-size:10px; color:#aab4d4;">I don't consolidate any statistics from your previous nickname</div>
<div style="text-align:center; font-size:10px; color:#aab4d4;">The stats are based on my log file from irssi, which hasn't been trimmed or cut since start. If you can't live with that just leave.</div>
<div style="text-align:center; font-size:10px; color:#aab4d4;">Created by ircioStats rev e3fb<span style="color:gold;">727</span></div>
<br>
</body>
</html>
